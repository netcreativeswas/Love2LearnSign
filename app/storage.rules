rules_version = '2';

service firebase.storage {
  // Lock rules to the canonical bucket used by the project.
  match /b/love-to-learn-sign.firebasestorage.app/o {

    function isAdminOrEditor() {
      return request.auth != null
        && request.auth.token.roles is list
        && ('admin' in request.auth.token.roles || 'editor' in request.auth.token.roles);
    }

    // ✅ Public READ for splashscreen video(s)
    match /bangla_sign_language/splashscreen/{allPaths=**} {
      allow read: if true;
      allow create, update, delete: if false;
    }

    // ✅ Public READ for dictionary, but uploads only for admin/editor.
    // ❌ Deletes are blocked on client side (handled by Cloud Functions / Admin SDK).
    match /bangla_sign_language/dictionary_eng_bnsl/{allPaths=**} {
      allow read: if true;
      allow create, update: if isAdminOrEditor();
      allow delete: if false;
    }

    // ❌ Everything else locked
    match /{allPaths=**} {
      allow read, write: if false;
    }
  }
}


